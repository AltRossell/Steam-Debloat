<Window x:Class="SteamDebloat.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
        ui:ThemeManager.IsThemeAware="True"
        ui:WindowHelper.UseModernWindowStyle="True"
        Title="Steam Debloat"
        Height="650"
        Width="1000"
        MinHeight="650"
        MinWidth="1000"
        Background="{DynamicResource BackgroundPrimaryBrush}"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        RenderOptions.BitmapScalingMode="HighQuality"
        UseLayoutRounding="True"
        TextOptions.TextFormattingMode="Display">
    
    <Grid Background="{DynamicResource BackgroundPrimaryBrush}">
        <!-- Main Content -->
        <Grid Margin="20,20,20,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="360"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel -->
            <Grid Grid.Column="0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Margin="0,0,16,0">
                    <!-- Header with Theme Toggle -->
                    <Grid Margin="0,0,0,20">
                        <TextBlock Text="Configuration" 
                                   FontSize="26" 
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   VerticalAlignment="Center"/>
                        
                        <!-- Theme Toggle Button -->
                        <Button x:Name="ThemeToggleButton"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Center"
                                Width="36"
                                Height="36"
                                Click="ThemeToggleButton_Click"
                                Cursor="Hand"
                                Background="Transparent"
                                BorderThickness="0"
                                ToolTip="Toggle Light/Dark Theme">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="border"
                                            Background="{TemplateBinding Background}"
                                            CornerRadius="18"
                                            Padding="6">
                                        <Viewbox Width="20" Height="20">
                                            <Canvas Width="24" Height="24">
                                                <!-- Moon Icon (Dark theme) -->
                                                <Path x:Name="MoonIcon"
                                                      Data="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"
                                                      Fill="{DynamicResource TextPrimaryBrush}"
                                                      Visibility="Visible"/>
                                                <!-- Sun Icon (Light theme) -->
                                                <Path x:Name="SunIcon"
                                                      Data="M12 17.5C14.4853 17.5 16.5 15.4853 16.5 13C16.5 10.5147 14.4853 8.5 12 8.5C9.51472 8.5 7.5 10.5147 7.5 13C7.5 15.4853 9.51472 17.5 12 17.5Z M12 1V3M12 23V25M4.22 4.22L5.64 5.64M18.36 18.36L19.78 19.78M1 12H3M21 12H23M4.22 19.78L5.64 18.36M18.36 5.64L19.78 4.22"
                                                      Stroke="{DynamicResource TextPrimaryBrush}"
                                                      StrokeThickness="2"
                                                      StrokeStartLineCap="Round"
                                                      StrokeEndLineCap="Round"
                                                      StrokeLineJoin="Round"
                                                      Visibility="Collapsed"/>
                                            </Canvas>
                                        </Viewbox>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter TargetName="border" Property="Background" Value="{DynamicResource BackgroundTertiaryBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter TargetName="border" Property="Opacity" Value="0.7"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </Grid>

                    <!-- Steam Directory Card -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel>
                            <TextBlock Text="Steam Directory" 
                                       FontSize="15" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <TextBox x:Name="SteamDirectoryTextBox"
                                         Grid.Column="0"
                                         Margin="0,0,8,0"/>
                                
                                <Button x:Name="BrowseSteamDirectoryButton"
                                        Grid.Column="1"
                                        Content="Browse"
                                        Width="90"
                                        Style="{StaticResource SecondaryButton}"
                                        Click="BrowseSteamDirectoryButton_Click"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Optimization Mode Card -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel>
                            <TextBlock Text="Optimization Mode" 
                                       FontSize="15" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <Button x:Name="ModeSelectionButton"
                                    Content="Normal 2023 June"
                                    Style="{StaticResource SecondaryButton}"
                                    Click="ModeSelectionButton_Click"
                                    HorizontalContentAlignment="Left"
                                    Padding="14,11,14,11"/>
                        </StackPanel>
                    </Border>

                    <!-- Options Card -->
                    <Border Style="{StaticResource Card}">
                        <StackPanel>
                            <TextBlock Text="Options" 
                                       FontSize="15" 
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource TextPrimaryBrush}"
                                       Margin="0,0,0,10"/>
                            
                            <CheckBox x:Name="CreateDesktopShortcut" 
                                      Content="Create desktop shortcut"
                                      IsChecked="True"/>
                            <CheckBox x:Name="AddToStartMenu" 
                                      Content="Add to Start Menu"
                                      IsChecked="True"/>
                            <CheckBox x:Name="RemoveFromStartup" 
                                      Content="Remove from system startup"
                                      IsChecked="True"/>
                            <CheckBox x:Name="UpdateSteam" 
                                      Content="Downgrade Steam to selected version"
                                      IsChecked="True"/>
                        </StackPanel>
                    </Border>

                    <!-- Action Button -->
                    <Button x:Name="StartButton"
                            Content="Optimize Steam"
                            Style="{StaticResource PrimaryButton}"
                            Click="StartButton_Click"
                            Margin="0,4,0,0"/>
                </StackPanel>

                <!-- Check Update Button -->
                <Border Grid.Row="1"
                        Margin="0,12,16,0">
                    <Button x:Name="CheckUpdateButton"
                            Content="Check for Updates"
                            Style="{StaticResource SecondaryButton}"
                            Click="CheckUpdateButton_Click"
                            HorizontalAlignment="Stretch">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border x:Name="border" 
                                        Background="{TemplateBinding Background}"
                                        BorderBrush="{TemplateBinding BorderBrush}"
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="8"
                                        Padding="{TemplateBinding Padding}">
                                    <StackPanel Orientation="Horizontal" 
                                                HorizontalAlignment="Center">
                                        <Path Data="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"
                                              Fill="{DynamicResource TextPrimaryBrush}"
                                              Width="16"
                                              Height="16"
                                              Stretch="Uniform"
                                              Margin="0,0,8,0"/>
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </StackPanel>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="border" Property="Background" Value="{DynamicResource SeparatorBrush}"/>
                                    </Trigger>
                                    <Trigger Property="IsPressed" Value="True">
                                        <Setter TargetName="border" Property="Opacity" Value="0.8"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                </Border>
            </Grid>

            <!-- Right Panel -->
            <Grid Grid.Column="1">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <!-- Info Banner -->
                        <Border Background="{StaticResource AccentBrush}"
                                CornerRadius="10"
                                Padding="20,18,20,18"
                                Margin="0,0,0,20">
                            <StackPanel>
                                <TextBlock Text="Steam Debloat" 
                                           FontSize="22" 
                                           FontWeight="Bold"
                                           Foreground="White"
                                           Margin="0,0,0,6"/>
                                <TextBlock Text="Advanced optimization tool for Steam on Windows" 
                                           FontSize="14"
                                           Foreground="White"
                                           Opacity="0.9"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- System Info -->
                        <TextBlock Text="System Information" 
                                   FontSize="20" 
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   Margin="0,0,0,14"/>

                        <Border Style="{StaticResource Card}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="140"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0"
                                           Text="Operating System"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,0,0,12"/>
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           x:Name="OSVersionText"
                                           Text="Loading..."
                                           FontSize="13"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           Margin="0,0,0,12"/>

                                <TextBlock Grid.Row="1" Grid.Column="0"
                                           Text="Architecture"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,0,0,12"/>
                                <TextBlock Grid.Row="1" Grid.Column="1"
                                           x:Name="OSArchText"
                                           Text="Loading..."
                                           FontSize="13"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           Margin="0,0,0,12"/>

                                <TextBlock Grid.Row="2" Grid.Column="0"
                                           Text="Administrator"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,0,0,12"/>
                                <TextBlock Grid.Row="2" Grid.Column="1"
                                           x:Name="AdminStatusText"
                                           Text="Checking..."
                                           FontSize="13"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           Margin="0,0,0,12"/>

                                <TextBlock Grid.Row="3" Grid.Column="0"
                                           Text="Steam Path"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           Margin="0,0,0,12"/>
                                <TextBlock Grid.Row="3" Grid.Column="1"
                                           x:Name="SteamPathText"
                                           Text="Searching..."
                                           FontSize="13"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           TextWrapping="Wrap"
                                           Margin="0,0,0,12"/>

                                <TextBlock Grid.Row="4" Grid.Column="0"
                                           Text="Configuration"
                                           FontSize="13"
                                           FontWeight="Medium"
                                           Foreground="{DynamicResource TextSecondaryBrush}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1"
                                           x:Name="SteamConfigText"
                                           Text="Searching..."
                                           FontSize="13"
                                           Foreground="{DynamicResource TextPrimaryBrush}"
                                           TextWrapping="Wrap"/>
                            </Grid>
                        </Border>

                        <!-- Restore Section -->
                        <TextBlock Text="Restore" 
                                   FontSize="20" 
                                   FontWeight="Bold"
                                   Foreground="{DynamicResource TextPrimaryBrush}"
                                   Margin="0,26,0,14"/>

                        <Border Style="{StaticResource Card}">
                            <StackPanel>
                                <TextBlock Text="Remove all optimizations and restore Steam to its original state." 
                                           FontSize="13"
                                           Foreground="{DynamicResource TextSecondaryBrush}"
                                           TextWrapping="Wrap"
                                           Margin="0,0,0,12"/>
                                
                                <Button x:Name="UninstallButton"
                                        Content="Restore Steam"
                                        Style="{StaticResource DangerButton}"
                                        Click="UninstallButton_Click"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Grid>

        <!-- Progress Overlay -->
        <Grid x:Name="ProgressOverlay"
              Background="#CC000000"
              Visibility="Collapsed"
              Panel.ZIndex="1000">
            <Border Background="{DynamicResource BackgroundSecondaryBrush}"
                    Width="380"
                    CornerRadius="12"
                    Padding="28,24,28,24"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1">
                <StackPanel>
                    <TextBlock x:Name="ProgressText"
                               Text="Processing..."
                               FontSize="18"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,20"/>
                    
                    <ProgressBar IsIndeterminate="True"
                                 Height="4"
                                 Margin="0,0,0,20"/>
                    
                    <Button x:Name="CancelButton"
                            Content="Cancel"
                            Style="{StaticResource SecondaryButton}"
                            Width="110"
                            Click="CancelButton_Click"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Completion Overlay -->
        <Grid x:Name="CompletionOverlay"
              Background="#CC000000"
              Visibility="Collapsed"
              Panel.ZIndex="1001">
            <Border Background="{DynamicResource BackgroundSecondaryBrush}"
                    Width="420"
                    CornerRadius="12"
                    Padding="32,28,32,28"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1">
                <StackPanel>
                    <Ellipse Width="56" Height="56"
                             Fill="{StaticResource SuccessBrush}"
                             HorizontalAlignment="Center"
                             Margin="0,0,0,18"/>
                    
                    <Grid Width="56" Height="56" 
                          HorizontalAlignment="Center"
                          Margin="0,-74,0,18">
                        <Path Data="M 15 28 L 24 37 L 41 20"
                              Stroke="White"
                              StrokeThickness="3"
                              StrokeStartLineCap="Round"
                              StrokeEndLineCap="Round"
                              Fill="Transparent"/>
                    </Grid>
                    
                    <TextBlock Text="Operation Completed"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,12"/>
                    
                    <TextBlock x:Name="CompletionMessageText"
                               Text="Operation completed successfully"
                               FontSize="14"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,24"/>
                    
                    <Button x:Name="CompletionOkButton"
                            Content="Done"
                            Style="{StaticResource PrimaryButton}"
                            Width="140"
                            HorizontalAlignment="Center"
                            Click="CompletionOkButton_Click"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Confirmation Overlay -->
        <Grid x:Name="ConfirmationOverlay"
              Background="#CC000000"
              Visibility="Collapsed"
              Panel.ZIndex="1001">
            <Border Background="{DynamicResource BackgroundSecondaryBrush}"
                    Width="480"
                    CornerRadius="12"
                    Padding="32,28,32,28"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1">
                <StackPanel>
                    <Ellipse Width="56" Height="56"
                             Fill="{StaticResource WarningBrush}"
                             HorizontalAlignment="Center"
                             Margin="0,0,0,18"/>
                    
                    <Grid Width="56" Height="56" 
                          HorizontalAlignment="Center"
                          Margin="0,-74,0,18">
                        <TextBlock Text="?"
                                   FontSize="36"
                                   FontWeight="Bold"
                                   Foreground="White"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,-4,0,0"/>
                    </Grid>
                    
                    <TextBlock x:Name="ConfirmationTitleText"
                               Text="Confirm Action"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,12"/>
                    
                    <TextBlock x:Name="ConfirmationMessageText"
                               Text="Are you sure you want to continue?"
                               FontSize="14"
                               Foreground="{DynamicResource TextSecondaryBrush}"
                               TextWrapping="Wrap"
                               TextAlignment="Center"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,24"
                               LineHeight="22"/>
                    
                    <StackPanel Orientation="Horizontal" 
                                HorizontalAlignment="Center">
                        <Button x:Name="ConfirmationNoButton"
                                Content="Cancel"
                                Style="{StaticResource SecondaryButton}"
                                Width="120"
                                Margin="0,0,12,0"/>
                        
                        <Button x:Name="ConfirmationYesButton"
                                Content="Continue"
                                Style="{StaticResource DangerButton}"
                                Width="120"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Mode Selection Overlay -->
        <Grid x:Name="ModeSelectionOverlay"
              Background="#CC000000"
              Visibility="Collapsed"
              Panel.ZIndex="999">
            
            <Border Background="{DynamicResource BackgroundSecondaryBrush}"
                    MaxWidth="880"
                    MaxHeight="580"
                    CornerRadius="12"
                    Padding="32,28,32,28"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1">
                
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <TextBlock Grid.Row="0"
                               Text="Select Optimization Mode"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="{DynamicResource TextPrimaryBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,24"/>

                    <ScrollViewer Grid.Row="1" 
                                  VerticalScrollBarVisibility="Auto"
                                  MaxHeight="380">
                        <StackPanel x:Name="MainSelectionPanel">
                            <UniformGrid x:Name="StableVersionsPanel" Columns="2" Rows="2" Margin="0,0,0,16"/>
                            <WrapPanel x:Name="ExperimentalVersionsPanel" HorizontalAlignment="Center"/>
                        </StackPanel>
                    </ScrollViewer>

                    <Button Grid.Row="2"
                            x:Name="BackButton"
                            Content="Close"
                            Style="{StaticResource SecondaryButton}"
                            Width="110"
                            Margin="0,20,0,0"
                            Click="BackButton_Click"/>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>